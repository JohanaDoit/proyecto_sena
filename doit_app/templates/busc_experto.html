{% extends "base.html" %}
{% load static %}
{% block content %}
<form method="get" action="{% url 'busc_experto' %}" style="margin-bottom: 20px;">
    <input type="text" name="q" class="form-control" placeholder="Buscar experto por nombre o usuario..." value="{{ searched_expert|default:'' }}" style="max-width:400px;display:inline-block;">
    <button type="submit" class="btn btn-primary">Buscar</button>
</form>
<link rel="stylesheet" href="{% static 'css/busc_experto.css' %}">
    <div class="contenedor-resultados">
        <h1>Resultados de la búsqueda para "{{ searched_expert|default:'[Término de búsqueda]' }}"</h1>

        <div id="mensaje-seleccion" style="display: none; text-align: center; margin-bottom: 20px; color: var(--verde); font-weight: bold;"></div>


        {% if expertos %}
            {% for experto in expertos %}
                <div class="experto-card">
                    <div class="experto-info">
                        {% if experto.foto_perfil %}
                            <img src="{{ experto.foto_perfil.url }}" alt="Foto de {{ experto.get_full_name|default:experto.username }}" class="experto-foto">
                        {% else %}
                            <img src="{% static 'images/default_profile.png' %}" alt="Foto de {{ experto.get_full_name|default:experto.username }}" class="experto-foto">
                        {% endif %}
                        <h3>{{ experto.get_full_name|default:experto.username }}</h3>
                        <p class="experto-servicio">
                            {% for esp in experto.especialidad.all %}{{ esp.NombreServicio }}{% if not forloop.last %}, {% endif %}{% endfor %}
                        </p>
                        <p class="experto-usuario">@{{ experto.username }}</p>
                    </div>
                    <div class="experto-contacto">
                        {% if experto.id %}
                            <a href="{% url 'chat' experto.id %}" class="boton-seleccionar">Seleccionar</a>
                        {% else %}
                            <span class="text-muted">No disponible</span>
                        {% endif %}
                    </div>
                </div>
            {% endfor %}
        {% elif searched_expert %}
            <div class="alert alert-warning">No se encontraron expertos para "{{ searched_expert }}".</div>
        {% endif %}

    </div>
</body>
</html>
{% endblock content %}